# RNA-Seq Analysis Pipeline

## Overview

This project is an RNA-Seq analysis pipeline adapted from the RNA-Seq analysis conducted for my master's thesis. The pipeline processes raw RNA-Seq data to generate meaningful insights into gene expression, utilising tools such as **HISAT2**, **SAMtools**, and **featureCounts**.

The workflow automates key steps, including read mapping, transcript quantification, and generation of count matrices for downstream analysis. The project is tailored for small-scale data analysis, optimised for systems with limited memory resources (e.g., 4GB RAM).

---

## Features

- **Raw Data Trimming**: Prepares raw FASTQ files for high-quality analysis.
- **Read Mapping**: Maps RNA-Seq reads to the reference genome using HISAT2.
- **Quantification**: Uses featureCounts to produce gene-level count matrices.
- **Output Files**:
  - Sorted and indexed BAM files.
  - Gene-level count tables.
  - Logs for each step.

---

## File Structure

```
├── genome/                   # Reference genome and annotation files
│   ├── Homo_sapiens.GRCh38.101.gtf
│   ├── genome/
├── rawdata/                  # Original raw RNA-Seq FASTQ files
├── trimmed/                  # Trimmed FASTQ files
├── mapping/                  # BAM files, count files, and logs
├── tools/                    # Scripts and utilities
├── rna_seq_workflow.sh       # Main pipeline script
├── featureCounts_htseq.txt   # Count matrix (example output)
└── README.md                 # This file
```

---

## Requirements

- Linux/Ubuntu environment
- 4GB RAM or more
- Tools installed:
  - [HISAT2](https://daehwankimlab.github.io/hisat2/)
  - [SAMtools](http://www.htslib.org/)
  - [featureCounts](http://bioinf.wehi.edu.au/featureCounts/)

---

## Usage

### 1. Clone the Repository

```bash
git clone https://github.com/Louisa-Mcintosh/RNA-Seq-Pipeline.git
cd RNA-Seq-Pipeline
```

### 2. Prepare Reference Files

Place the genome and GTF files in the `genome/` directory. Ensure the index files for HISAT2 are created using:

```bash
hisat2-build genome.fasta genome/genome
```

### 3. Run the Pipeline

Execute the main pipeline script to process your data:

```bash
bash rna_seq_workflow.sh
```

### 4. Outputs

- Mapped reads: Stored in `mapping/` as sorted BAM files.
- Gene counts: Generated by featureCounts in the same directory.

---

## Pipeline Steps

1. **Trim Raw Reads**  
   - Quality trimming is done on all raw FASTQ files in the `rawdata/` directory. Output is saved to `trimmed/`.

2. **Align Reads**  
   - HISAT2 maps the reads to the reference genome, producing SAM files that are sorted and indexed.

3. **Quantify Gene Expression**  
   - featureCounts generates gene-level counts based on the sorted BAM files and annotation GTF.

---

## Example Command Outputs

### HISAT2 Mapping

```bash
hisat2 -p 10 -x genome/genome -U trimmed/SRR21186745_1.fastq.gz -S mapping/SRR21186745.sam
```

### SAMtools Sorting and Indexing

```bash
samtools view -Sb mapping/SRR21186745.sam | samtools sort -o mapping/SRR21186745_sorted.bam
samtools index mapping/SRR21186745_sorted.bam
```

### featureCounts

```bash
featureCounts -T 10 -a genome/Homo_sapiens.GRCh38.101.gtf -o mapping/SRR21186745_counts.txt mapping/SRR21186745_sorted.bam
```

---

## Adaptation

This pipeline was adapted from the RNA-Seq analysis performed for my master's thesis. The adjustments ensure it runs efficiently on limited-resource machines while still producing accurate and reproducible results.

---

## Contact

For questions or collaboration, please contact:

**Louisa McIntosh**  
Email: [louisanatalie@hotmail.com](mailto:louisanatalie@hotmail.com)  
LinkedIn: [Louisa McIntosh](https://www.linkedin.com/in/louisa-m-292640121/)

---

Feel free to use, modify, or contribute to this project!

